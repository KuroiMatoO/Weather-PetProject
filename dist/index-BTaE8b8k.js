(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const _ of n.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}})();function ee(t,e,o,r,a,n){r?a>0?t.src="img/Day_rain.png":n>0?t.src="img/Day_snow.png":e>=30&&o==0?t.src="img/Day_cloudy.png":t.src="img/Day.png":a>0&&o>0?t.src="img/Night_rain.png":n>0&&o>0?t.src="img/Night_snow.png":e>=30&&o==0?t.src="img/Night_cloudy.png":t.src="img/Night.png"}function te(t,e,o,r,a){r>0?t.src="img/Day_rain.png":a>0?t.src="img/Day_snow.png":e<.8*o?t.src="img/Day_cloudy.png":t.src="img/Day.png"}async function I(t,e){const o=`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${t}&longitude=${e}&localityLanguage=en`,r=await fetch(o);if(!r.ok)throw new Error("Location API request failed");return r.json()}async function T(t,e){const o=`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${e}&current=temperature_2m,relative_humidity_2m,is_day,precipitation,rain,snowfall,cloud_cover,pressure_msl,wind_speed_10m&hourly=temperature_2m&daily=temperature_2m_max,sunshine_duration,temperature_2m_min,precipitation_sum,rain_sum,showers_sum,snowfall_sum&wind_speed_unit=ms&forecast_days=16`,r=await fetch(o);if(!r.ok)throw new Error("Weather API request failed");return r.json()}async function R(){try{let t,e;u&&d?(t=await I(u,d),e=await T(u,d)):(t=await I(),e=await T(t.latitude,t.longitude));const o=new Date;console.log(t),console.log(e);const r=String(o.getHours()).padStart(2,"0"),a=String(o.getMinutes()).padStart(2,"0"),n=e.current.cloud_cover,_=e.current.precipitation,V=e.current.is_day,J=e.current.rain,U=e.current.snowfall;let F=document.querySelector("#icon img");F=ee(F,n,_,V,J,U),document.querySelector("#temperature").innerHTML=Math.round(e.current.temperature_2m)+"°",document.querySelector("#time").innerHTML=`${r}:${a}`;const W={month:"long",day:"numeric",weekday:"long"};document.querySelector("#date").innerHTML=new Intl.DateTimeFormat("en-US",W).format(o),document.querySelector("#location").innerHTML=`${t.countryCode}, ${t.city}`,document.querySelector("#wind").innerHTML=`Wind: ${e.current.wind_speed_10m} m/s`,document.querySelector("#humidity").innerHTML=`Humidity: ${e.current.relative_humidity_2m}%`,document.querySelector("#pressure").innerHTML="Pressure: "+Math.round(e.current.pressure_msl*.7500637554)+" mm";let G=document.querySelectorAll(".charts-css th"),K=document.querySelectorAll(".area td .data"),$=document.querySelectorAll(".area td"),N=document.querySelectorAll(".line td"),i=new Date().getHours();for(let l=0;l<10;l++)l==0&&($[l].style.setProperty("--start",`calc(${e.hourly.temperature_2m[i-2]}/45)`),$[l].style.setProperty("--end",`calc(${e.hourly.temperature_2m[i]}/45)`),N[l].style.setProperty("--start",`calc(${e.hourly.temperature_2m[i-2]}/45)`),N[l].style.setProperty("--end",`calc(${e.hourly.temperature_2m[i]}/45)`)),$[l].style.setProperty("--start",`calc(${e.hourly.temperature_2m[i]}/45)`),$[l].style.setProperty("--end",`calc(${e.hourly.temperature_2m[i+2]}/45)`),N[l].style.setProperty("--start",`calc(${e.hourly.temperature_2m[i]}/45)`),N[l].style.setProperty("--end",`calc(${e.hourly.temperature_2m[i+2]}/45)`),l<9&&(K[l].innerHTML=Math.round(e.hourly.temperature_2m[i])+"°",i=i+2);for(let l=0;l<9;l++){let f=new Date(o);f.setHours(o.getHours()+2*l),G[l].innerHTML=`${f.getHours()}:00`}let z=document.querySelectorAll(".daily_date"),Q=document.querySelectorAll(".day img"),X=document.querySelectorAll(".daily_temp"),A=e.daily.sunshine_duration,Y=A.reduce((l,f)=>l+f,0)/A.length;for(let l=0;l<7;l++){let f=new Date(o);f.setDate(o.getDate()+l);const Z={month:"long",day:"numeric"};z[l].innerHTML=new Intl.DateTimeFormat("en-US",Z).format(f),te(Q[l],A[l],Y,e.daily.rain_sum[l],e.daily.snowfall_sum[l]),X[l].innerHTML=Math.round((e.daily.temperature_2m_max[l]+e.daily.temperature_2m_min[l])/2)+"°"}}catch(t){console.error(t)}}let u,d;E();R();let M=document.querySelector(".location"),oe=document.querySelector("#change_location_btn"),re=document.querySelector("#location_header button"),k=document.querySelector("#dark_background"),w=document.querySelector(".tip"),s={},m=document.querySelector("#location_search input"),q=document.querySelector(".search_result"),y=document.querySelectorAll(".result_item"),P=document.querySelectorAll(".search_result .city"),le=document.querySelectorAll(".search_result .flag img"),ae=document.querySelectorAll(".search_result .country"),C,c={},D=document.querySelector(".favorite_locations"),g=document.querySelectorAll(".favorite_item"),h=document.querySelectorAll(".favorite_locations .city"),B=document.querySelectorAll(".favorite_locations .flag img"),j=document.querySelectorAll(".favorite_locations .country"),ce=document.querySelectorAll(".add_favorite"),ne=document.querySelectorAll(".remove_favorite"),O=localStorage.length,p,b,ie=document.querySelector("#detect_location");function v(){M.className=="location invisible"?(M.className="location",k.style.display="block"):(M.className="location invisible",k.style.display="none")}function H(){let t=Object.keys(c).length;!m.value&&t?(q.className="search_result hidden",D.className="favorite_locations",w.className="tip"):!m.value&&!t?(q.className="search_result hidden",D.className="favorite_locations hidden",w.className="tip"):m.value&&m.value.length>1&&t?(q.className="search_result",D.className="favorite_locations",w.className="tip hidden"):m.value.length>1&&(q.className="search_result",D.className="favorite_locations hidden",w.className="tip hidden")}async function se(t){const e=`https://geocoding-api.open-meteo.com/v1/search?name=${t}&count=10&language=en&format=json`,o=await fetch(e);if(!o.ok)throw new Error("Location API request failed");return o.json()}async function S(){try{const t=await se(m.value);if(m.value&&m.value.length>1&&t.results){let o=Object.keys(t.results).length;for(let r=0;r<o&&r<5;r++){s[`loc${r}`]={city:t.results[r].name,country:t.results[r].country,latitude:t.results[r].latitude,longitude:t.results[r].longitude,countryCode:t.results[r].country_code.toLowerCase()},ae[r].innerHTML=s[`loc${r}`].country,le[r].src=`https://open-meteo.com/images/country-flags/${s[`loc${r}`].countryCode}.svg`;let a=P[r].childNodes[P[r].childNodes.length-1];if(a.nodeValue=s[`loc${r}`].city,y[r].style.display="flex",r<o-1&&r<4&&(y[r].style.borderBottomLeftRadius="0px",y[r].style.borderBottomRightRadius="0px"),o<5){for(let n=5;n>o;n--)y[n-1].style.display=="flex"&&(y[n-1].style.display="none");r==o-1&&(y[r].style.borderBottomLeftRadius="5px",y[r].style.borderBottomRightRadius="5px")}}H()}let e=Object.keys(c).length;if(console.log("FLDLength = "+e),e==0)H();else{for(let o=0;o<e;o++){h[o].nodeValue=c[`loc${o}`].city,j[o].innerHTML=c[`loc${o}`].country,B[o].src=`https://open-meteo.com/images/country-flags/${c[`loc${o}`].countryCode}.svg`;let r=h[o].childNodes[h[o].childNodes.length-1];if(r.nodeValue=c[`loc${o}`].city,g[o].style.display="flex",o<e-1&&o<2&&(g[o].style.borderBottomLeftRadius="0px",g[o].style.borderBottomRightRadius="0px"),e<3){for(let a=3;a>e;a--)g[a-1].style.display!=="none"&&(g[a-1].style.display="none");o==e-1&&(g[o].style.borderBottomLeftRadius="5px",g[o].style.borderBottomRightRadius="5px")}}H()}}catch(t){console.error(t)}}function ue(t){let e=Object.keys(c).length;if(e<3){c[`loc${e}`]={city:s[`loc${t}`].city,country:s[`loc${t}`].country,latitude:s[`loc${t}`].latitude,longitude:s[`loc${t}`].longitude,countryCode:s[`loc${t}`].countryCode};let o=JSON.stringify(c);localStorage.setItem("fav",o),p=localStorage.getItem("fav"),b=JSON.parse(p),h[e].nodeValue=c[`loc${e}`].city,j[e].innerHTML=c[`loc${e}`].country,B[e].src=`https://open-meteo.com/images/country-flags/${c[`loc${e}`].countryCode}.svg`;let r=h[e].childNodes[h[e].childNodes.length-1];r.nodeValue=c[`loc${e}`].city,S(),L()}else console.log("fav data is 3"),L()}function de(t){delete c[`loc${t}`];const e={};Object.keys(c).sort().forEach((r,a)=>{e[`loc${a}`]=c[r]}),c=e;let o=JSON.stringify(c);localStorage.setItem("fav",o),p=localStorage.getItem("fav"),b=JSON.parse(p),S(),L()}function x(t,e){const o=e.currentTarget;o.classList.contains("favorite_item")?(console.log("Favorite item clicked:",t),u=c[`loc${t}`].latitude,d=c[`loc${t}`].longitude,console.log(u,d)):o.classList.contains("result_item")?(console.log("Search result item clicked:",t),u=s[`loc${t}`].latitude,d=s[`loc${t}`].longitude,console.log(u,d)):console.log("Unknown class clicked:",t),T(u,d),v(),E(),R()}function me(){u="",d="",T(u,d),v(),E(),R()}function E(){const t=document.querySelector(".loader"),e=document.querySelector(".loader_bg");t.className="loader",e.className="loader_bg",setTimeout(()=>{t.className="loader hidden",e.className="loader_bg hidden"},1500)}oe.addEventListener("click",()=>{S(),L(),v()});re.addEventListener("click",v);k.addEventListener("click",v);O?(p=localStorage.getItem("fav"),b=JSON.parse(p),c=b):O="0";m.addEventListener("input",()=>{clearTimeout(C),C=setTimeout(S,500)});ce.forEach((t,e)=>{t.addEventListener("click",()=>ue(e))});ne.forEach((t,e)=>{t.addEventListener("click",()=>de(e))});g.forEach((t,e)=>{t.addEventListener("click",o=>{x(e,o)})});y.forEach((t,e)=>{t.addEventListener("click",o=>{x(e,o)})});ie.addEventListener("click",me);S();let ye=document.querySelector("#debug #variables"),ge=document.querySelector("#debug #local_storage");function L(){ye.innerHTML=JSON.stringify(c),ge.innerHTML=JSON.stringify(localStorage)+" localLength = "+O+" Object.keys(favoriteLocationData).length = "+Object.keys(c).length}L();
